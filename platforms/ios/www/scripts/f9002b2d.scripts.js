var app=function(){return{initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("load",this.onLoad,!1),document.addEventListener("deviceready",this.onDeviceReady,!1)},onLoad:function(){},onDeviceReady:function(){document.addEventListener("backbutton",this.onBackKeyDown,!1),navigator.notification.alert("Hello")},onBackKeyDown:function(){navigator.notification.alert("Back Button")}}}();angular.module("lpApp",["ngRoute","ngResource"]).constant("USE_CACHED_CONFIG",1).config(["$routeProvider",function(a){a.when("/",{resolve:{hasDSP:["$location","AppStorageService",function(a,b){b.DSP.getAll()?a.path("/home"):a.path("/welcome")}]}}).when("/get-started",{templateUrl:"views/public/get-started.html"}).when("/home",{templateUrl:"views/public/home.html",controller:"HomeCtrl",resolve:{getDSPList:["AppStorageService",function(a){return a.DSP.getAll()}]}}).when("/welcome",{templateUrl:"views/public/welcome.html",resolve:{setLocationText:["$rootScope",function(a){a.appLocation="Welcome to Launchpad!"}]}}).when("/app-settings",{templateUrl:"views/public/app-settings.html",controller:"AppSettingsCtrl"}).when("/dsp-settings",{templateUrl:"views/public/settings/dsp-settings.html",controller:"DSPListCtrl",resolve:{getDSPList:["AppStorageService",function(a){return a.DSP.getAll()}]}}).when("/dsp-settings/:dsp",{templateUrl:"views/public/settings/dsp-settings-expand.html",controller:"DSPSettingsCtrl",resolve:{getDSP:["$route","$q","SystemService","AppStorageService",function(a,b,c,d){return d.DSP.get(a.current.params.dsp)}]}}).when("/get-dsp-form",{templateUrl:"views/utility/forms/get-dsp-form.html",controller:"GetDSPCtrl"}).when("/login/:dsp",{templateUrl:"views/public/login.html",controller:"LoginCtrl",resolve:{getDSPConfig:["$route","$http","$q","$location","AppStorageService","UserService",function(a,b,c,d,e){var f=e.DSP.get(a.current.params.dsp);return f.url===e.URL.get().currentURL&&d.replace().url("/launchpad"),f}]}}).when("/logout",{resolve:{logout:["$location","$rootScope","UserService","StorageService",function(a,b,c,d){d.sessionStorage.clear(),c.session().delete(),c.reset(),b.authenticated=!1,a.path("/")}]}}).when("/launchpad",{templateUrl:"views/launchpad.html",controller:"LaunchPadCtrl",resolve:{getGroups:["AppStorageService",function(a){return a.Apps.get()}],getDSPInfo:["AppStorageService",function(a){return a.Config.get()}]}}).when("/launchpad/:groupId",{templateUrl:"views/launchpad-group.html",controller:"LaunchPadGroupCtrl",resolve:{getApps:["$route","AppStorageService",function(a,b){return b.Apps.getAppsFromGroup(a.current.params.groupId)}],getDSPInfo:["AppStorageService",function(a){return a.Config.get()}]}}).when("/profile",{templateUrl:"views/profile.html",controller:"ProfileCtrl",resolve:{userInfo:["UserService",function(a){return a.profile().get()}],userApps:["UserService","$q",function(a,b){function c(a){angular.forEach(a.app_groups,function(a){angular.forEach(a.apps,function(a){f.push(a)})})}function d(a){angular.forEach(a.no_group_apps,function(a){angular.forEach(a.apps,function(a){f.push(a)})})}var e=b.defer(),f=[];return a.session().get(function(a){c(a),d(a),e.resolve(f)},function(a){e.reject(a)}),e.promise}]}}).otherwise({redirectTo:"/"})}]).config(["$httpProvider",function(a){a.defaults.headers.common["X-DreamFactory-Application-Name"]="launchpad"}]).run(["$route","$rootScope","$location","$http","UserService","AppStorageService",function(a,b,c,d,e,f){b.$on("$routeChangeStart",function(a,g){var h=["/launchpad/:groupId","/launchpad","/profile"],i=g.$$route.originalPath;angular.forEach(h,function(a){i===a&&(f.User.get().sessionId&&(d.defaults.headers.common["X-DreamFactory-Session-Token"]=f.User.get().sessionId),b.authenticated=f.User.get().authenticated,e.currentDSPUrl=f.URL.get().currentURL,e.session().get(function(){c.url()},function(){c.url("/")}))})})}]),angular.module("lpApp").controller("NavCtrl",["$scope","$rootScope",function(a,b){a.goBack=function(){return"Home"===b.appLocation?!1:(history.back(),void 0)}}]).controller("HomeCtrl",["$scope","$rootScope","getDSPList",function(a,b,c){b.appLocation="Home",a.dsps=c}]).controller("LoginCtrl",["$scope","$rootScope","$location","$q","AppStorageService","getDSPConfig","UserService","MessageService",function(a,b,c,d,e,f,g,h){b.appLocation="Login: "+f.name,a.currentDSP=f,a.user={},a.userLogin=function(b){a.$broadcast("user:userLogin",b)},a.guestLogin=function(){a.$broadcast("user:guestLogin")},a._userLogin=function(a){var b=d.defer();return g.session().save(a,function(a){b.resolve(a)},function(a){throw new Error(h.getFirstMessage(a))}),b.promise},a._guestLogin=function(){var a=d.defer();return g.session().get(function(b){a.resolve(b)},function(a){throw new Error(h.getFirstMessage(a))}),a.promise},a.$on("user:userLogin",function(b,d){try{g.currentDSPUrl=a.currentDSP.url,a._userLogin(d).then(function(b){e.User.save(b),e.URL.save(a.currentDSP),a.currentDSP.config=b,e.Apps.save(a.currentDSP),e.Config.save(a.currentDSP),c.replace().url("/launchpad")})}catch(f){console.error(f)}}),a.$on("user:guestLogin",function(){g.currentDSPUrl=a.currentDSP.url,a._guestLogin().then(function(b){console.log(b),e.User.save(b),e.URL.save(a.currentDSP),a.currentDSP.config=b,e.Apps.save(a.currentDSP),e.Config.save(a.currentDSP),c.replace().url("/launchpad")})})}]).controller("AppSettingsCtrl",["$scope","$rootScope",function(a,b){b.appLocation="Settings"}]).controller("DSPListCtrl",["$scope","$rootScope","getDSPList",function(a,b,c){b.appLocation="Settings: DSP List",a.dsps=c}]).controller("DSPSettingsCtrl",["$scope","$rootScope","getDSP","AppStorageService","SystemService","NotificationService",function(a,b,c,d,e,f){b.appLocation="Settings: "+c.name,console.log(c),a.currentDSP=c,a.UISettings=c.UISettings,a.saveDSPSettings=function(b){a.$broadcast("settings:save",b)},a.updateConfig=function(){a.$broadcast("settings:updateFromServer")},a.removeDSP=function(){a.$broadcast("settings:removeDSP")},a.$on("settings:save",function(b,c){try{d.DSP.UISettings.save(a.currentDSP,c)}catch(e){console.error(e)}}),a.$on("settings:updateFromServer",function(){try{e.config(a.currentDSP.url).get(function(b){d.DSP.Config.save(a.currentDSP,b)},function(a){console.log(a)})}catch(b){console.error(b)}}),a.$on("settings:removeDSP",function(){try{var b={message:"You are about to delete "+a.currentDSP.name+" from your lists",confirmCallback:d.DSP.delete(a.currentDSP),title:"Delete DSP"};f.confirmDialog(b)}catch(c){console.error(c)}})}]).controller("GetDSPCtrl",["$scope","$rootScope","$location","SystemService","AppStorageService",function(a,b,c,d,e){b.appLocation="Add A DSP",a.dsp={},a.getDSP=function(b){console.log("Get a DSP"),a.$broadcast("dsp:get",b)},a.$on("dsp:get",function(a,b){console.log("Get a dsp message received");try{d.config(b.url).get(function(a){b.config=a,b.UISettings={openRegistration:!1,guestUsers:!1,unGroupedApps:{}},e.DSP.save(b),c.url("/")},function(a){console.log(a)})}catch(f){console.error(f)}})}]),angular.module("lpApp").controller("ProfileCtrl",["$scope","$rootScope","userInfo","userApps","UserService","StringService","MessageService",function(a,b,c,d,e,f,g){b.appLocation="Profile: "+c.display_name,a.user=c,a.apps=d,console.log(a.user),a.submitUserProfile=function(b){console.log("User profile Submitted"),a.$broadcast("submit:profile",b)},a.cancelUserProfile=function(){a.$broadcast("cancel:profile")},a.verifyUserPassword=function(b){a.$broadcast("verify:password",b)},a._submitUserInfo=function(a){var b={default_app_id:a.default_app_id,display_name:a.display_name,email:a.email,first_name:a.first_name,last_name:a.last_name,phone:a.phone,security_question:a.security_question,security_answer:a.security_answer};e.profile().save(b,function(){return!0},function(a){throw new Error("Submit Profile Error: "+g.getFirstMessage(a))})},a._submitUserPassword=function(b){if(b.new_password&&a._verifyPasswordMatch){var c={old_password:b.old_password,new_password:b.new_password};e.password().save(c,function(){return!0},function(a){throw new Error("Submit Password Error: "+g.getFirstMessage(a))})}},a._verifyPasswordMatch=function(a){return f.areIdentical(a.new_password,a.verify_password)},a._resetUI=function(){a.user=e.profile().get()},a.$on("submit:profile",function(b,c){try{a._submitUserPassword(c),a._submitUserInfo(c),a._resetUI()}catch(d){}}),a.$on("verify:password",function(b,c){a.identical=a._verifyPasswordMatch(c)}),a.$on("cancel:profile",function(){console.log("Profile Change Canceled"),a.user=getInfo})}]),angular.module("lpApp").controller("LaunchPadCtrl",["$scope","$rootScope","getGroups","getDSPInfo",function(a,b,c,d){b.appLocation=d.name+": Groups",a.groups=c}]).controller("LaunchPadGroupCtrl",["$scope","$rootScope","getApps","getDSPInfo","AppLaunchService","StringService","StorageService",function(a,b,c,d,e,f,g){b.appLocation=d.name+": "+c.name,a.group=c,a.launchApp=function(b){console.log("Launch App Message"),a.$broadcast("app:launch",b)},a._getAppInfo=function(b){if(console.log("Getting "+b+" App Info"),a.group.apps[b])return a.group.apps[b];throw new Error("App identified by id "+b+" not found.")},a.$on("app:launch",function(a,b){console.log("Launch App Message Received");try{e.launchApp(b),g.sessionStorage.setCurrentApp(b)}catch(c){console.error(c)}})}]),angular.module("lpApp").controller("EventsCtrl",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("lpApp").factory("df",[function(){var a,b="http://localhost:8080/rest/api_docs/user",c="launchpad";return window.authorizations.add("X-DreamFactory-Application-Name",new ApiKeyAuthorization("X-DreamFactory-Application-Name",c,"header")),window.authorizations.add("Content-Type",new ApiKeyAuthorization("Content-Type","application/json","header")),a=new SwaggerApi({url:b,supportedSubmitMethods:["get","post","put","patch","merge","delete"]}),a.authorizations=window.authorizations,a.build(),a}]),angular.module("lpApp").factory("UrlService",[function(){return{makeSlug:function(a){return a.toLowerCase().split(" ").join("-")}}}]).factory("StringService",[function(){return{makeExcerpt:function(a,b){var c=a.split(" ",b).join(" ");return a.split(" ").length>=b?c+"...":a},makeSlug:function(a){return a.toLowerCase().split(" ").join("-")},areIdentical:function(a,b){function c(a,b){return a.length==b.length}function d(a,b){for(var c=Math.min(a.length,b.length),d=0;c>d;d++)if(a.charAt(d)!==b.charAt(d))return!1;return!0}return a=a||"",b=b||"",c(a,b)&&d(a,b)?!0:!1},getOriginFromString:function(a){return a.split("/",3).join("/")}}}]).factory("MessageService",[function(){return{getFirstMessage:function(a){return a.data.error[0].message},getAllMessages:function(){}}}]).factory("SessionService",[function(){return{save:function(a,b){return"string"!=typeof b&&(b=angular.toJson(b)),sessionStorage.setItem(a,b),!0},get:function(a){var b=sessionStorage.getItem(a);if(!b)return!1;try{return b=angular.fromJson(b)}catch(c){return b}},getObject:function(a){return JSON.parse(sessionStorage.getItem(a))},"delete":function(a){sessionStorage.removeItem(a)},clear:function(){sessionStorage.clear()},howMany:function(){return sessionStorage.length()},getAll:function(){var a={};return angular.forEach(sessionStorage,function(b,c){a[c]=b}),a},isAppOpen:function(a){var b=this.get("currentOpenApps");return b[a.id]},setCurrentApp:function(a){if(this.save("currentApp",a))return!0;throw new Error("Unable to save current app identifier.")},addToOpenApps:function(a){var b=this.get("currentOpenApps");b?(b[a.id]=a,this.save("currentOpenApps",b)):(b={},b[a.id]=a,this.save("currentOpenApps",b))},getFromOpenApps:function(a){var b=this.get("currentOpenApps");if(console.log(b),b&&b[a.id])return b[a.id];throw new Error("Unable to reopen "+a.name)},removeFromOpenApps:function(a){var b=this.get("currentOpenApps");b[a]&&(delete b[a],this.save("currentOpenApps",b))}}}]).factory("AppStorageService",["StorageService","StringService",function(a,b){return{DSP:{save:function(c){var d=a.localStorage.get("DSPList")||{},e=d.counter||0;if(e++,d.counter=e,c.id=d.counter,c.slug=b.makeSlug(c.name),d.platforms=d.platforms||{},d.platforms[c.id]=c,a.localStorage.save("DSPList",d))return!0;throw new Error("Unable to save DSP")},get:function(b){var c=a.localStorage.get("DSPList");if(c.platforms[b])return c.platforms[b];throw new Error("Unable to find DSP"+b)},update:function(){},"delete":function(b){var c=a.localStorage.get("DSPList");if(c.platforms[b.id])return delete c.platforms[b.id],a.localStorage.save("DSPList",c),!0;throw new Error("Unable to delete DSP"+b.name+" with id of "+b.id)},getAll:function(){var b=a.localStorage.get("DSPList");return b.platforms},Config:{save:function(b,c){var d=a.localStorage.get("DSPList");if(d.platforms[b.id])return d.platforms[b.id].config=c,a.localStorage.save("DSPList",d),!0;throw new Error("Unable to save "+b.name+" settings")}},UISettings:{save:function(b,c){var d=a.localStorage.get("DSPList");if(d.platforms[b.id])return d.platforms[b.id].UISettings=c,a.localStorage.save("DSPList",d),!0;throw new Error("Unable to save "+b.name+" UI settings")}},UserSettings:{save:function(b,c){var d=a.localStorage.get("DSPList");if(d.platforms[b.id])return d.platforms[b.id].UserSettings=c,a.localStorage.save("DSPList",d),!0;throw new Error("Unable to save "+b.name+" User settings")}}},User:{save:function(b){var c=a.sessionStorage.get("User")||{};if(c.sessionId=b.session_id,c.displayName=b.display_name,c.authenticated=!0,a.sessionStorage.save("User",c))return!0;throw new Error("Unable to set User "+b.displayName)},get:function(){return a.sessionStorage.get("User")}},URL:{save:function(b){var c=a.sessionStorage.get("URL")||{};if(c.currentURL=b.url,a.sessionStorage.save("URL",c))return!0;throw new Error("Unable to save "+b.name+" settings")},get:function(){return a.sessionStorage.get("URL")}},Apps:{save:function(b){var c=a.sessionStorage.get("Apps")||{},d={};if(c.appGroups=b.config.app_groups,d.name=b.UISettings.unGroupedApps.name||"UnGrouped Apps",d.id=b.UISettings.unGroupedApps.id||0,d.description=b.UISettings.unGroupedApps.description||"Apps not assigned to a group.",d.apps=b.config.no_group_apps,c.appGroups.push(d),a.sessionStorage.save("Apps",c))return!0;throw new Error("Unable to save Apps to session.")},get:function(){return a.sessionStorage.get("Apps")},getAppsFromGroup:function(b){var c=a.sessionStorage.get("Apps"),d=[];return angular.forEach(c.appGroups,function(a){a.id==b&&(d=a)}),d}},Config:{save:function(b){if(a.sessionStorage.save("Config",b))return!0;throw new Error("Unable to save Config to session.")},get:function(){return a.sessionStorage.get("Config")}}}}]).factory("StorageService",[function(){return{localStorage:{save:function(a,b){return"string"!=typeof b&&(b=angular.toJson(b)),localStorage.setItem(a,b),!0},get:function(a){var b=localStorage.getItem(a);if(!b)return!1;try{return b=angular.fromJson(b)}catch(c){return b}},getObject:function(a){return JSON.parse(localStorage.getItem(a))},"delete":function(a){localStorage.removeItem(a)},clear:function(){localStorage.clear()},howMany:function(){return localStorage.length()},getAll:function(){var a={};return angular.forEach(localStorage,function(b,c){a[c]=b}),a}},sessionStorage:{save:function(a,b){return"string"!=typeof b&&(b=angular.toJson(b)),sessionStorage.setItem(a,b),!0},get:function(a){var b=sessionStorage.getItem(a);if(!b)return!1;try{return b=angular.fromJson(b)}catch(c){return b}},getObject:function(a){return JSON.parse(sessionStorage.getItem(a))},"delete":function(a){sessionStorage.removeItem(a)},clear:function(){sessionStorage.clear()},howMany:function(){return sessionStorage.length()},getAll:function(){var a={};return angular.forEach(sessionStorage,function(b,c){a[c]=b}),a},isAppOpen:function(a){var b=this.get("currentOpenApps");return b[a.id]},setCurrentApp:function(a){if(this.save("currentApp",a))return!0;throw new Error("Unable to save current app identifier.")},addToOpenApps:function(a){var b=this.get("currentOpenApps");b?(b[a.id]=a,this.save("currentOpenApps",b)):(b={},b[a.id]=a,this.save("currentOpenApps",b))},getFromOpenApps:function(a){var b=this.get("currentOpenApps");if(console.log(b),b&&b[a.id])return b[a.id];throw new Error("Unable to reopen "+a.name)},removeFromOpenApps:function(a){var b=this.get("currentOpenApps");b[a]&&(delete b[a],this.save("currentOpenApps",b))}}}}]).factory("AppLaunchService",[function(){var a={};return{launchApp:function(b){if(a[b.id]=window.open(b.launch_url,b.name,"location=yes,menubar=yes,titlebar=yes"),a[b.id])return!0;throw new Error("Unable to launch "+b.name)},reopenApp:function(b){if(a[b.id].show())return!0;throw new Error("Unable to ReOpen "+b.name)},closeApp:function(){},hideApp:function(){},hideAppContainer:function(){}}}]).factory("ServicesPlatforms",["StorageService",function(a){return{getServicesPlatformsList:function(){return a.localStorage.get("ServicesPlatformsList")},getDSPInfo:function(a){switch(a){case"dsp-one":return{name:"DSP One",slug:"dsp-one",url:{external:"http://10.0.0.8:8080",settings:"#/dsp-settings/dsp-one"},user:{email:"michael@mandatodigital.com",password:"zymurGY12@12"}};case"next":return{name:"Next",slug:"next",url:{external:"https://next.cloud.dreamfactory.com",settings:"#/dsp-settings/dsp-two"},user:{email:"jason@dreamfactory.com",password:"coondogg"}};case"dsp-local-test-user":return{name:"DSP Local Test User",slug:"dsp-local-test-user",url:{external:"http://10.0.0.8:8080",settings:"dsp-local-test-user"},user:{email:"test2@test.com",password:"test2"}};default:return{}}}}}]).factory("UserService",["$resource","$q","AppStorageService",function(a){return{currentDSPUrl:"",session:function(b){return a(this.currentDSPUrl+"/rest/user/session",{},{check:{method:"GET",isArray:!1,headers:b}})},profile:function(){return a(this.currentDSPUrl+"/rest/user/profile")},password:function(){return a(this.currentDSPUrl+"/rest/user/password")},register:function(){return a(this.currentDSPUrl+"/rest/user/password")},reset:function(){this.currentDSPUrl=null}}}]).factory("SystemService",["$resource",function(a){return{config:function(b){return a(b+"/rest/system/config")}}}]).factory("NotificationService",["CordovaReady",function(){function a(a,b){for(var c in b)a[c]=b[c]}return{alertDialog:function(a,b,c,d){return navigator.notification.alert(a,b,c,d)},confirmDialog:function(b){function c(){return!0}var d={message:"Confirm ?",confirmCallback:c,title:"Confirm",buttonLabels:["OK","Cancel"]},e=a(d,b);return navigator.notification.confirm(e.message,e.confirmCallback,e.title,e.buttonLabels)}}}]).factory("CordovaReady",[function(){return function(a){var b=[],c=function(){b.push(Array.prototype.slice.call(arguments))};return document.addEventListener("deviceready",function(){b.forEach(function(b){a.apply(this,b)}),c=a},!1),function(){return c.apply(this,arguments)}}}]),angular.module("lpApp").directive("locationText",["$rootScope",function(){return{restrict:"E",scope:{locationText:"=location"},template:"{{locationText}}"}}]);